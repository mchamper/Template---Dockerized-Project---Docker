<ng-container *ngIf="{
  isLoading: form.requestH.isLoading$() | async,
  isSuccess: form.requestH.isSuccess$() | async
} as vm">
  <ng-container *ngIf="vm.isSuccess; else noSuccessTpl">
    <nz-alert
      nzType="success"
      [nzMessage]="message"
      [nzDescription]="description"
      nzShowIcon
    >
      <ng-template #message>
        <strong>Registro completo</strong>
      </ng-template>

      <ng-template #description>
        Se le ha enviado un email de verificación a la dirección de correo ingresada. Por favor, confirme su dirección de correo para poder disfrutar de todos los servicios de CoffeeBreak.
      </ng-template>
    </nz-alert>
  </ng-container>

  <ng-template #noSuccessTpl>
    <app-request-handler [form]="form">
      <form nz-form nzLayout="vertical" [formGroup]="form.group" (ngSubmit)="register()">
        <div class="row">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="form.getError('first_name')">
              <nz-form-label>Nombre</nz-form-label>
              <input nz-input formControlName="first_name" placeholder="&nbsp;">
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-control [nzErrorTip]="form.getError('last_name')">
              <nz-form-label>Apellido</nz-form-label>
              <input nz-input formControlName="last_name" placeholder="&nbsp;">
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-control [nzErrorTip]="form.getError('email')">
              <nz-form-label>Email</nz-form-label>
              <input nz-input formControlName="email" placeholder="&nbsp;">
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-control [nzErrorTip]="form.getError('password')">
              <nz-form-label>Contraseña</nz-form-label>
              <input nz-input type="password" formControlName="password" placeholder="&nbsp;">
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-control [nzErrorTip]="form.getError('password_confirmation')">
              <nz-form-label>Confirmar contraseña</nz-form-label>
              <input nz-input type="password" formControlName="password_confirmation" placeholder="&nbsp;">
            </nz-form-control>
          </nz-form-item>
        </div>

        <div class="mt-3">
          <button [appLoadingBtn]="vm.isLoading" class="btn btn-primary">
            Registrarme
          </button>
        </div>
      </form>
    </app-request-handler>
  </ng-template>
</ng-container>
